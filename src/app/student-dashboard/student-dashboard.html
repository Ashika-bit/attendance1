<div class="dashboard-container">
    <!-- Sidebar -->
    <div class="sidebar">
        <div class="user-email">
            {{ studentEmail }}
        </div>
        <ul>
            <li (click)="toggleCourses()">Courses</li>
            <ul *ngIf="showCourses" class="courses-list">
                <li *ngFor="let course of courses" (click)="selectCourse(course)">
                    {{ course }}
                </li>
            </ul>
        </ul>
    </div>

    <!-- Main Content -->
    <div class="content">
        <h2 *ngIf="selectedCourse">Attendance for {{ selectedCourse }}</h2>

        <!-- Colored attendance alert -->
        <p *ngIf="selectedCourse" [ngStyle]="{
          'background-color': getAttendanceColor(),
          padding: '10px',
          'border-radius': '5px',
          color: getAttendanceColor() === 'yellow' ? 'black' : 'white'
        }">
            Your Attendance: {{ attendancePercentage }}%
        </p>

        <!-- Line Chart showing attendance over dates -->
        <div *ngIf="selectedCourse" class="chart-container">
            <canvas baseChart [data]="lineChartData" [labels]="lineChartLabels" [options]="lineChartOptions"
                [legend]="lineChartLegend" [type]="lineChartType">
            </canvas>
        </div>

        <!-- Combined Table + Form Section -->
        <div *ngIf="selectedCourse" class="attendance-management">
            <!-- Date-wise attendance table -->
            <div class="attendance-table-container">
                <h3>Date-wise Attendance</h3>
                <table class="attendance-table">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let record of attendanceData[selectedCourse]" (click)="onRecordClick(record)"
                            style="cursor: pointer;">
                            <td>{{ record.date }}</td>
                            <td
                                [ngClass]="{ present: record.status === 'Present', absent: record.status === 'Absent' }">
                                {{ record.status }}
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>



            <!-- Welcome message + prompt to select course (when no course selected) -->
            <div *ngIf="!selectedCourse" style="margin-top: 20px;">
                <h2>Welcome, {{ studentEmail }}</h2>
                <p>Select a course to view attendance</p>
            </div>
        </div>
    </div>